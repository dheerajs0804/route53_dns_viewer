<div class="dns-viewer-container">
  <!-- Header -->
  <div class="header">
    <div class="header-left">
      <mat-icon class="header-icon">search</mat-icon>
      <span class="header-title">Route 53 DNS Viewer</span>
    </div>
    <div class="header-right">
      <button mat-icon-button (click)="logout()" class="logout-btn">
        <mat-icon>logout</mat-icon>
      </button>
    </div>
  </div>

  <div class="content">
    <!-- Search Form -->
    <div class="search-section">
      <h2 class="section-title">Search DNS Records</h2>
      <p class="section-subtitle">Select a hosted zone and enter a prefix to filter records</p>

      <form [formGroup]="searchForm" class="search-form">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Hosted Zone</label>
            <mat-form-field appearance="fill" class="hosted-zone-select">
              <mat-select formControlName="hostedZoneId" (selectionChange)="onZoneSelectionChange()">
                <mat-option *ngFor="let zone of hostedZones" [value]="zone.id">
                  {{ zone.name }} ({{ zone.id }})
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <div class="form-group">
            <label class="form-label">Search Prefix</label>
            <mat-form-field appearance="fill" class="search-input">
              <input matInput 
                     formControlName="prefix" 
                     placeholder="e.g., www, api, subdomain">
              <button mat-icon-button 
                      matSuffix 
                      (click)="clearSearch()" 
                      *ngIf="searchForm.get('prefix')?.value"
                      class="clear-btn">
                <mat-icon>close</mat-icon>
              </button>
            </mat-form-field>
            <span class="form-hint">Leave empty to show all records</span>
          </div>

          <div class="form-group">
            <button mat-raised-button 
                    color="primary" 
                    (click)="searchRecords()"
                    [disabled]="searchForm.invalid || isLoading"
                    class="search-btn">
              <mat-icon>refresh</mat-icon>
              <span>Search Records</span>
            </button>
          </div>
        </div>
      </form>
    </div>

    <!-- Results Section -->
    <div class="results-section" *ngIf="dnsRecords.length > 0 || (searchForm.get('hostedZoneId')?.value && !isLoading)">
      <div class="results-header">
        <div class="results-title">
          <h2>DNS Records ({{ dnsRecords.length }} found)</h2>
          <p class="results-subtitle">
            Showing records for {{ getZoneName(searchForm.get('hostedZoneId')?.value) }}
          </p>
        </div>
        <button mat-raised-button 
                (click)="exportToCsv()" 
                [disabled]="dnsRecords.length === 0"
                class="download-btn">
          <mat-icon>download</mat-icon>
          Download CSV
        </button>
      </div>

      <div class="table-container" *ngIf="dnsRecords.length > 0">
        <table class="dns-table">
          <thead>
            <tr>
              <th class="record-name-header">RECORD NAME</th>
              <th class="type-header">TYPE</th>
              <th class="ttl-header">TTL</th>
              <th class="values-header">VALUES</th>
              <th class="actions-header">ACTIONS</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let record of dnsRecords" class="table-row">
              <td class="record-name-cell">
                <div class="record-name">{{ record.name }}</div>
              </td>
              <td class="type-cell">
                <span class="type-badge" [class]="'type-' + record.type.toLowerCase()">
                  {{ record.type }}
                </span>
              </td>
              <td class="ttl-cell">
                {{ record.ttl || '-' }}
              </td>
              <td class="values-cell">
                <div class="values-container">
                  <div *ngFor="let value of record.values" class="value-item">
                    {{ value }}
                  </div>
                  <div *ngIf="record.aliasTarget" class="alias-target">
                    Alias: {{ record.aliasTarget }}
                  </div>
                  <div *ngIf="record.values.length === 0 && !record.aliasTarget" class="no-values">
                    No values
                  </div>
                </div>
              </td>
              <td class="actions-cell">
                <button mat-icon-button [matMenuTriggerFor]="menu" class="actions-btn">
                  <mat-icon>more_horiz</mat-icon>
                </button>
                <mat-menu #menu="matMenu">
                  <button mat-menu-item (click)="copyToClipboard(record.name)">
                    <mat-icon>content_copy</mat-icon>
                    Copy Name
                  </button>
                  <button mat-menu-item (click)="copyToClipboard(record.values.join(', '))">
                    <mat-icon>content_copy</mat-icon>
                    Copy Values
                  </button>
                </mat-menu>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- No Results -->
      <div class="no-results" *ngIf="!isLoading && dnsRecords.length === 0 && searchForm.get('hostedZoneId')?.value">
        <mat-icon class="no-results-icon">search_off</mat-icon>
        <h3>No DNS records found</h3>
        <p *ngIf="searchForm.get('prefix')?.value">
          No records found matching prefix "{{ searchForm.get('prefix')?.value }}"
        </p>
        <p *ngIf="!searchForm.get('prefix')?.value">
          No records found in the selected hosted zone
        </p>
      </div>
    </div>

    <!-- Loading State -->
    <div class="loading-section" *ngIf="isLoading">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Loading DNS records...</p>
    </div>
  </div>
</div>